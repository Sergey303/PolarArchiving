@using System.Linq
@using System.Xml.Linq
@model IndexModel
@{
    ViewData["Title"] = "Home Page";

    XElement[] titles = null;

    if (Model != null && Model.XRecord != null)
    {
        titles = Model.XRecord.Elements("inverse")
            .Where(i => i.Attribute("prop").Value == "has-title")
            .Select(i => i.Element("record"))
            .ToArray();
    }
}

<table width="100%" style="table-layout:fixed;" border="0">
    <colgroup>
        <col width="150" />
        <col width="100%" />
        <col width="410" />
    </colgroup>
    <tr valign="top">
        <td />
        <td>
            <div id="logo" style="" width="500" height="99">
                <a href=""><img src="~/img/logo2.gif" width="391" height="61" vspace="12" alt="СО РАН с 1957 года" border="0" /></a>
            </div>
        </td>
        <td>
            <div id="login" style="">
                <table cellpadding="0" cellspacing="0" border="0" width="100%">
                    <tr>
                        <td class="text_arial_small">имя: </td>
                        <td width="40%"><input type="text" class="form_login" /></td>
                        <td class="text_arial_small">пароль: </td>
                        <td width="40%"><input type="password" class="form_login" /></td>
                        <td><input type="image" width="19" height="19" src="~/img/btn_login.gif" /></td>
                    </tr>
                    <tr>
                        <td />
                        <td colspan="4" class="text_arial_small"><a>регистрация</a> | <a>забыли пароль?</a></td>
                    </tr>
                </table>
            </div>
        </td>
    </tr>
    <tr valign="top">
        <td rowspan="2">
            <div id="menu" style="">
                <a href="?id=w20070417_7_1744"><img src="~/img/i_home.gif" width="10" height="10" hspace="4" border="0" alt="Главная страница"></a>
                <a href="mailto:pavl@iis.nsk.su?subject=soran1957.ru%20 PA_folders24-59_0003_0896"><img src="~/img/i_mail.gif" width="10" height="10" hspace="11" border="0" alt="Написать письмо"></a>
                <br>
                <hr noshade="1" size="1" color="#cccccc">
                <div class="text_menu">
                    <div class="p_menu">
                        <a href="?id=w20070417_7_1744"><b>Начало</b></a>
                        <hr noshade="1" size="3" color="#cccccc">
                        <a href="?id=w20070417_3_6186"><b>СО РАН</b></a>
                        <hr noshade="1" size="3" color="#cccccc">
                        <a href="?id=w20070417_4_1010"><b>Первичные фотоматериалы</b></a>
                        <hr noshade="1" size="3" color="#cccccc">
                        <a href="?id=newspaper_cassetteId"><b>Архив газет "За науку в Сибири"</b></a>
                        <hr noshade="1" size="3" color="#cccccc">
                        <a href="?id=w20070417_3_4658"><b>О проекте</b></a>
                        <hr noshade="1" size="3" color="#cccccc">
                        <a href="?id=usefullLinks"><b>Полезные ссылки</b></a>
                    </div>
                </div>
                <hr noshade="1" size="3" color="#cccccc">
            </div>
        </td>
        <td>
            <div id="search" style="">
                <form action="">
                    <input type="hidden" name="p" value="search">
                    <input type="hidden" name="tp" value="@Model.TabDirection">
                    <table cellpadding="0" cellspacing="0" border="0">
                        <tbody>
                            <tr>
                                <td class='search_option@(Model.TabDirection=="photo-doc"?"_s":"")'>
                                    <a href="?sdirection=photo-doc">Фотографии</a>
                                </td>
                                <td class="search_option@(Model.TabDirection=="person"?"_s":"")">
                                    <a href="?sdirection=person">Персоны</a>
                                </td>
                                <td class="search_option@(Model.TabDirection=="org-sys"?"_s":"")">
                                    <a href="?sdirection=org-sys">Организации</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <table cellpadding="0" cellspacing="0" border="0" width="100%" height="55">
                        <tbody>
                            <tr>
                                <td width="100%" class="search_form">
                                    <input name="searchstring" type="text" class="form_search">
                                </td>
                                <td class="search_form">
                                    <input type="image" width="63" height="19" src="~/img/btn_search.gif" style="margin-right:5px;">
                                </td>
                            </tr>
                            <tr valign="top">
                                <td colspan="2" class="search_form">
                                    <input type="checkbox" id="search_all" disabled="disabled" style="border:0px solid #036;">
                                    <label for="search_all">искать по отдельным словам</label> | <a>расширенный поиск</a>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </td>

        <td></td>
    </tr>
    <tr valign="top">
        <td>
            @if (Model == null) { }
            else if (Model.SearchResults != null)
            {
                foreach (object[] ob in Model.SearchResults)
                {
                    <div>
                        <a href="?id=@(ob[0])">@(ob[1])</a>
                    </div>
                }
            }
            else if (Model.Id == null) { }
            else
            {
                <div>[@Model.Type]</div>
                <h2>@Model.Name</h2>
                <div>
                    @if (Model.StartDate != null)
                    {
                        <span>@Model.StartDate</span>
                    }
                    @if (Model.EndDate != null)
                    {
                        <span>-@Model.EndDate</span>
                    }
                </div>
                <div>
                    @if (Model.Description != null)
                    {
                        <span>@Model.Description</span>
                    }
                </div>

                <hr />

                @foreach (XElement inv in Model.XRecord.Elements("inverse").Where(i => i.Attribute("prop").Value == "http://fogid.net/o/reflected"))
                {
                    XElement doc = inv.Element("record").Element("direct").Element("record");
                    string iid = doc.Attribute("id").Value;
                    string tp = doc.Attribute("type").Value;
                    string nm = doc.Elements("field").FirstOrDefault(f => f.Attribute("prop").Value == "http://fogid.net/o/name")?.Value;
                    string ur = doc.Elements("field").FirstOrDefault(f => f.Attribute("prop").Value == "http://fogid.net/o/uri")?.Value;
                    string dt = doc.Elements("field").FirstOrDefault(f => f.Attribute("prop").Value == "http://fogid.net/o/from-date")?.Value;

                    <div style="float:left;width:126px;height:150px;font-size:10px;">
                        <table align="center">
                            <tr><td><a href="?id=@iid"><img src="/Docs/GetPhoto?u=@ur&amp;s=small" alt="@nm" /></a></td></tr>
                            <tr><td align="center">@dt</td></tr>
                        </table>
                        
                    </div>

                }


            }
        </td>

        <!-- =========================== Правая панель ======================== -->
        <td valign="top">
            @if (titles != null && titles.Count() > 0)
            {
                <h2>Титулы</h2>
                <ul>
                    @foreach (XElement tit in titles)
                    {
                        <li>@tit.Value</li>
                    }
                </ul>
            }
        </td>
    </tr>
    <tr valign="top"><td colspan="3"><hr></td></tr>
    <tr valign="top"><td></td><td colspan="2">(c) Фотоархив Сибирского отделения Российской академии наук</td></tr>
</table>
